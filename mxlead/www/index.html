<!DOCTYPE html>

<html>
    <head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <title>MXLead</title>
    <link href="css/jquery.mobile.internal-png.css" rel="stylesheet" type="text/css">
    <link href="css/jquery.mobile.structure.css" rel="stylesheet" type="text/css">
    <link href="css/jquery.mobile.theme.css" rel="stylesheet" type="text/css">
    <link href="css/swatches.css" rel="stylesheet" type="text/css">
    <link href="css/fonts.css" rel="stylesheet" type="text/css">
    <script src="js/jquery.js" type="text/javascript"></script>
    <script src="js/jquery.mobile-1.4.0-rc.1.js" type="text/javascript"></script>
    <script>


	function logOut(){
		
		 localStorage.setItem("login", "");
	     localStorage.setItem("user", "");

		$.mobile.changePage($("#login"));

	}



	function getSurvey(){
		
	
		
	var user=localStorage.getItem("user");
	
	
	$.ajax({
  	
			url : "http://fajjemobile.info/mxlead/WebService/getList.php",
				type: "GET",
				async: true,
				data: {user:user},
	   		    success:function(response){
                       
				//	   alert(response);
					  
					  var list=response.split(",");
	$("#nameList").empty();
	for(var i =1;i<list.length;i++){
	
	var listData=list[i].split("#");
	
	$("#nameList").append($('<li/>', {    //here appending `<li>`
    
}).append($('<a/>', {    //here appending `<a>` into `<li>`
  'href':'#',
  'rel':'external',
  'data-transition':'pop',
  'text': listData[1],
  'onclick':'getData('+listData[0]+')'
})));
	
	}
					  
					  
					  	$('#nameList').listview('refresh');
            $.mobile.loading( "hide" );
			    },
                error: function (request, status, error) {
					$.mobile.loading( "hide" );
                    alert("Couldn't connect to the internet");
                } 
					   
	            
	
	});
	
	}














	
	$(document).ready(function () {
	
	if(localStorage.getItem("login")!="Yes"){

	$.mobile.changePage($("#login"));		
		
		}else{
			$.mobile.loading( "show");
			getSurvey();
			
			
			}
			
				
});


	
	
	function loginCheck(){
	var userid=$('#username').val();
	var pass=$('#password').val();
	
	
	
	$.ajax({
  	
			url : "http://fajjemobile.info/mxlead/WebService/checkLogin.php",
				type: "GET",
				async: true,
				data: {user:userid,password:pass},
	   		    success:function(response){
                       
					   
					   
					   if(response!="No"){
						   localStorage.setItem("login", "Yes");
						   localStorage.setItem("user", response);
						   $.mobile.changePage($("#surveyList"),"slide");
						   getSurvey();
						   	
						   }else{
$('#username').val="";							   
							   }
	$('#password').val="";
	            },
        error: function (request, status, error)  
        {
            alert("Coundn't connect to the internet");     
        }
	
	});
	
	}
	
	

	
		function insert(){


$("#huser_id").val(localStorage.getItem("user"));
var postData = $('#ajaxform').serializeArray();
 
   
  
   
    $.ajax(
    {
        url : "http://fajjemobile.info/mxlead/WebService/insert.php",
        type: "POST",
		async: true,
        data : postData,
        success:function(data, textStatus, jqXHR) 
        {
           location.reload();
        },
        error: function (request, status, error)  
        {
            alert("Coundn't connect to the internet");     
        }
    });
  
	}
	
	
	
		function updateStatus(){


var dataID = $('#dataidv').val();
var status = $('#status').val();
 
  
   
    $.ajax(
    {
        url : "http://fajjemobile.info/mxlead/WebService/update.php",
        type: "GET",
		async: true,
        data : {ID:dataID,status:status},
        success:function(data, textStatus, jqXHR) 
        {

           if(data=="Yes"){
			   $('#popupUpdate').popup('close');
			   }
        },
        error: function (request, status, error)  
        {
            alert("Coundn't connect to the internet");     
        }
    });
  
	}
	
	
function getData(id){	
		
	$.ajax({
  	
			url : "http://fajjemobile.info/mxlead/WebService/getdata.php",
				type: "GET",
				async: true,
				data: {ID:id},
	   		    success:function(response){
                       
					   //alert(response);
					  var fetchData=response.split(",");
						$('#dataidv').val(fetchData[0]);
						$('#namev').val(fetchData[1]);
						$('#telv').val(fetchData[2]);
						$('#addressv').val(fetchData[3]);
						$('#cityv').val(fetchData[4]);
						$('#zipv').val(fetchData[5]);
						$('#emailv').val(fetchData[6]);
						$('#interestv option:eq('+fetchData[7]+')').prop('selected', true);
						$('#cdatev').val(fetchData[9]);
						$('#ratev').val(fetchData[10]);
						$('#havev option[value='+fetchData[8]+']').attr('selected', 'selected');
						$('#systemv option[value='+fetchData[11]+']').attr('selected', 'selected');
						
            			$.mobile.loading( "hide" );
					  	$.mobile.changePage($("#viewData"));
			
			    },
                error: function (request, status, error) {
					$.mobile.loading( "hide" );
                    alert("Couldn't connect to the internet");
                } 
					   
	            
	
	});
	
	
}
	
	
    </script>
    </head>
    <body>
<div data-role="page" id="surveyList">
      <div data-role="header">
    <h1>MX Security</h1>
    <a href="#" data-role="button" data-icon="delete" data-iconpos="left" onclick="logOut()">Logout</a><a href="#insert" data-role="button" data-icon="plus" data-iconpos="notext">Button</a> </div>
      <div data-role="content">
        <ul data-role="listview" data-filter="true" data-filter-placeholder="Search Records..." id = "nameList">
        </ul>
  </div>
      <div data-role="footer" data-position="fixed">
    <h4>MX Security Lead Program</h4>
  </div>
    </div>
<div data-role="page" id="login">
      <div data-role="header">
    <h1>MX Security</h1>
  </div>
      <div data-role="content">
    <div data-role="fieldcontain">
          <center>
        <img id="lock" src="img/SessionLock.png">
      </center>
          <input type="text" name="username" id="username" value="" placeholder="Enter Username"  data-clear-btn="true" required/>
          <input type="password" name="password" id="password" value="" placeholder="Enter Password"  data-clear-btn="true"  required/>
          <button data-icon="lock" onclick="loginCheck()">Login</button>
          <button data-icon="delete">Cancel</button>
        </div>
  </div>
      <div data-role="footer" data-position="fixed">
    <h4>MX Security Lead Program</h4>
  </div>
    </div>
</div>
<div data-role="page" id="insert">
      <div data-role="header">
    <h1>MX Security</h1>
    <a href="#" data-role="button" data-icon="arrow-l" data-iconpos="notext" onclick="history.back();">Button</a> </div>
      <div data-role="content">
    <form name="ajaxform" id="ajaxform" action="#insert" method="POST">
          <div data-role="fieldcontain">
        <input type="text" name="name" id="name"  value="" placeholder="Enter Name"  data-clear-btn="true" required/>
        <input type="tel" name="tel" id="tel" value="" placeholder="Enter Tel"  data-clear-btn="true"  required/>
        <textarea name="address" id="address" placeholder="Enter Address"></textarea>
        <input type="text" name="city" id="city"  value="" placeholder="Enter City"  data-clear-btn="true" required/>
        <input type="tel" name="zip" id="zip" value="" placeholder="Enter Zip"  data-clear-btn="true"  required/>
        <input type="email" name="email" id="email"  value="" placeholder="Enter Email"  data-clear-btn="true" required/>
        <select name="interest" id="interest">
              <option value="">Select Interest</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
            </select>
        <select name="haveSystem" id="haveSystem">
              <option value="">Have System</option>
              <option value="Yes">Yes</option>
              <option value="No">No</option>
            </select>
        <input type="text" onfocus="(this.type='number')"  onblur="(this.type='text')" name="rate" id="rate" value="" placeholder="Enter Rate"  data-clear-btn="true"  required/>
        <select name="systemQuoted" id="systemQuoted">
              <option value="">System Quoted</option>
              <option value="Lynx" >Lynx</option>
              <option value="Simon" >Simon</option>
              <option value="2gig">2gig</option>
              <option value="DSC" >DSC</option>
              <option value="Hardwired" >Hardwired</option>
            </select>
        <input type="text" name="cdate" id="cdate" value="" placeholder="Enter Next Contact Date"  data-clear-btn="true"  required/>
        <input type="hidden" id="huser_id" name="huser_id" value="9"/>
        <input type="button" data-icon="edit" onclick="insert()" value="Submit" />
        <button data-icon="delete">Cancel</button>
      </div>
        </form>
  </div>
    </div>
<div data-role="page" id="viewData">
	

      <div data-role="header">
    <h1>MX Security</h1>
    <a href="#" data-role="button" data-icon="arrow-l" data-iconpos="notext" onclick="history.back();">Button</a><a href="#popupUpdate"  data-icon="edit" data-iconpos="left" data-rel="popup" data-position-to="window" data-transition="pop">Update</a> </div>
      <div data-role="content">
    <div data-role="popup" id="popupUpdate" class="ui-corner-all" data-theme="a">  
          <div style="padding:10px 20px;padding-top:0px">             
        <center><h3 style="margin-top:0px" >Update Status</h3></center>
        <select name="status" id="status">
              <option value="">Select Status</option>
              <option value="Lynx" >Lynx</option>
              <option value="Simon" >Simon</option>
              <option value="2gig">2gig</option>
            </select>
        <input type="button" data-icon="edit" onclick="updateStatus()" value="Submit" />
      </div>
        </div>
    <form name="updateform" id="updateform" action="#" method="POST">
          <div data-role="fieldcontain">
       	<input type="hidden" name="dataid" id="dataidv" value="" />
        <input type="text" name="name" id="namev"  value="" placeholder="Enter Name"  data-clear-btn="true" readonly/>
        <input type="tel" name="tel" id="telv" value="" placeholder="Enter Tel"  data-clear-btn="true"  readonly/>
        <textarea name="address" id="addressv" placeholder="Enter Address" readonly></textarea>
        <input type="text" name="city" id="cityv"  value="" placeholder="Enter City"  data-clear-btn="true" readonly/>
        <input type="tel" name="zip" id="zipv" value="" placeholder="Enter Zip"  data-clear-btn="true"  readonly/>
        <input type="email" name="email" id="emailv"  value="" placeholder="Enter Email"  data-clear-btn="true" readonly/>
        <select name="interestv" id="interestv" disabled>
              <option value="">Select Interest</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
            </select>
        <select name="havev" id="havev" disabled>
              <option value="">Have System</option>
              <option value="Yes">Yes</option>
              <option value="No">No</option>
            </select>
        <input type="text" onfocus="(this.type='number')"  onblur="(this.type='text')" name="rate" id="ratev" value="" placeholder="Enter Rate"  data-clear-btn="true"  readonly/>
        <select name="systemv" id="systemv" disabled>
              <option value="">System Quoted</option>
              <option value="Lynx" >Lynx</option>
              <option value="Simon" >Simon</option>
              <option value="2gig">2gig</option>
              <option value="DSC" >DSC</option>
              <option value="Hardwired" >Hardwired</option>
            </select>
        <input type="text" name="cdate" id="cdatev" value="" placeholder="Enter Next Contact Date"  data-clear-btn="true"  readonly/>
      </div>
        </form>
  </div>
      <div data-role="footer">
    <h4>MX Security Lead Program</h4>
  </div>
    </div>
<script type="text/javascript" src="cordova.js"></script>
</body>
</html>
